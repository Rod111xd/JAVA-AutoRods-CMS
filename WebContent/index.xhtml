<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough">

<h:head>
	<meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no'/>
	<h:outputStylesheet  name="css/uikit.min.css" />
	<h:outputStylesheet  name="css/alertify.min.css" />
	<h:outputStylesheet  name="css/style.css" />
	<title>AutoRods</title>
</h:head>

<h:body>
	<div class="header-img"></div>
	<div id="menu" class="uk-navbar-container uk-light" style="background-color:#1e1e1e">
		<div class="uk-navbar" uk-navbar="">
		    <div class="uk-navbar-left">
		
		        <ul class="uk-navbar-nav">
		            <li class="uk-active"><h:outputLink value="index.xhtml"><span class="uk-icon" uk-icon="icon:home"></span> Início</h:outputLink></li>
		            <h:panelGroup layout="block" rendered="#{AdminLogin.logged}">
						<li class="uk-active"><h:outputLink value="addPost.xhtml"><span class="uk-icon" uk-icon="icon:world"></span> Criar</h:outputLink></li>
					</h:panelGroup>
		        </ul>
		
		    </div>
			<div class="uk-navbar-center">
		            AUTORODS - O SITE SOBRE O MUNDO DAS RODAS

		    </div>
		    <div class="uk-navbar-right">
		
		        <ul class="uk-navbar-nav">
			        <h:panelGroup layout="block" rendered="#{not AdminLogin.logged and not UserLogin.logged}">
						<li class="uk-active"><h:outputLink value="login.xhtml"><span class="uk-icon" uk-icon="icon:sign-in"></span> Entrar</h:outputLink></li>
					</h:panelGroup>

					<h:panelGroup layout="block" rendered="#{AdminLogin.logged or UserLogin.logged}">
						<li class="uk-active"><h:outputLink value="logout.xhtml"><span class="uk-icon" uk-icon="icon:sign-out"></span> Sair</h:outputLink></li>
					</h:panelGroup>
				</ul>
		    </div>
		
		</div>
	</div>

	<div class="content">
		<div class="uk-grid contentGrid" uk-grid="">
		    <div class="uk-width-1-3@s uk-width-1-3@l">
			    <div class="content-box1">
			    	<h:panelGroup layout="block" rendered="#{AdminLogin.logged}">
						<div class="adminDetails">
				    		<h:outputText value="#{AdminLogin.name}"/>
				    	</div>
					</h:panelGroup>
					<h:panelGroup layout="block" rendered="#{UserLogin.logged}">
						<div class="userDetails">
				    		<h:outputText value="#{UserLogin.name}"/>
				    		<h:outputText rendered="#{not empty UserLogin.preferences}" value="#{UserLogin.preferences}"/>
				    		<h:graphicImage  name="#{UserLogin.avatar}" class="cardImage"/>
				    	</div>
					</h:panelGroup>
				    <div class="uk-inline lateral-menu">
				    	<h:form id="searchForm">
				    		<h:outputLabel class="uk-form-label">PESQUISA</h:outputLabel>
							<h:inputText id="pesquisa" name="pesquisa" value="#{PostBean.pesquisa}" class="uk-input" p:placeholder="Pesquisar.."/><br/><br/>
							<h:commandButton action="#{PostBean.searchTitle()}" value="Pesquisar" class="uk-button uk-button-secondary">
								<f:ajax execute="pesquisa" render="postsRepeat"/>
								<f:ajax render="cleanSearch"/>
							</h:commandButton>
							<h:panelGroup id="cleanSearch">
								<h:form rendered="#{not empty PostBean.pesquisa}">
									<h:commandButton class="uk-button" value="Limpar">
										<f:ajax listener="#{PostBean.cleanSearch()}" render="searchForm:pesquisa"/>
										<f:ajax execute="pesquisa" render="postsRepeat"/>
										<f:ajax render="searchForm:cleanSearch"/>
									</h:commandButton>
								</h:form>
							</h:panelGroup>
					    </h:form>
					    <h:panelGroup rendered="#{not AdminLogin.logged}">
					    	<h:form >
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('car')}" value="Carros"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('motocicle')}" value="Motos"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('bus')}" value="Ônibus"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('truck')}" value="Caminhões"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('airplane')}" value="Aviões"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('helicopter')}" value="Helicópteros"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('boat')}" value="Barcos"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
								<h:commandLink class="uk-button uk-button-primary uk-width-1-2" action="#{PostBean.searchCategory('ship')}" value="Navios"><f:ajax render="postsRepeat"/><f:ajax render="cleanSearch"/></h:commandLink>
				        	</h:form>
					    </h:panelGroup>
					    <h:panelGroup rendered="#{AdminLogin.logged}">
					    	<hr class="uk-divider-icon"/>
					    	<h:outputLink class="uk-button uk-button-primary buttonFill" value="addPost.xhtml">Criar publicação</h:outputLink>
					    </h:panelGroup>
				    </div>
			    </div>
		    </div>
		    <div class="uk-width-2-3@s uk-width-2-3@l">
			    <div class="content-box2">
			    	
			    	
			    	<h:panelGroup id="postsRepeat">
				    	<div class="uk-grid contentGrid" uk-grid="">
				    		<h:panelGrid rendered="#{empty PostBean.list}">
			    				<p>Não há o que exibir :(</p>
			    			</h:panelGrid>
				    		<ui:repeat var="post" value="#{PostBean.list}">
						    	<div class='uk-width-1-2@s uk-width-1-2@l'>
									<div class='uk-card uk-card-default uk-card-small uk-card-hover'>
										<div class='uk-card-media-top'>
											<h:link outcome="content.xhtml?id=#{post.id}">
												<h:graphicImage  name='#{post.urlMedia}' class='cardImage'/>
												<h:outputLink class="uk-label uk-position-absolute uk-transform-center" style="left: 17%; top: 5%" value="#">#{post.category}</h:outputLink>
												<h:outputLink class="uk-label uk-position-absolute uk-transform-center" style="left: 17%; top: 13%" value="#">#{post.type}</h:outputLink>
												<h:panelGroup class="uk-position-absolute uk-transform-center" rendered="#{AdminLogin.id eq post.idAdmin}" style="left: 90%; top: 8%">
								                	<div class="uk-inline">
												    	<span class="uk-icon-button" uk-icon="icon: cog;ratio:1.6"></span>
													    <div uk-dropdown="mode: click">
													    		<a onclick="document.getElementById('formDelete:idDelete').value=#{post.id};" class="removeButton"><span class="uk-icon" uk-icon="icon:close"></span></a><br/>
										                		<h:outputLink value="editPost.xhtml?id=#{post.id}"><span class="uk-icon" uk-icon="icon:pencil"></span></h:outputLink>
													    </div>
													</div>
								                </h:panelGroup>
											</h:link>
							            </div>
							            <div class='uk-card-body'>
							                <h3 class='uk-card-title'>
							                <h:link outcome="content.xhtml?id=#{post.id}" class="noLink">
							                	#{post.title}
							                </h:link>
							                </h3>
							                
							                <p>#{post.subtitle}</p>
							            </div>
									</div>
							    </div>
							</ui:repeat>
						</div>
					</h:panelGroup>
			    </div>
		    </div>
		</div>
	</div>
	
	<div id="deletePostModal" style="display:none;text-align:center;">
		<h:form id="formDelete" style="text-align:center;">
			<h:inputHidden id="idDelete" class="idDelete" value="#{PostBean.id}"></h:inputHidden>
			<h:commandButton class="uk-button uk-button-danger" action="#{PostBean.deletePost}" value="Sim"></h:commandButton> ou 
			<h:outputLink class="uk-button uk-button-primary" onclick="alertify.closeAll();" value="#">Fechar</h:outputLink>
		</h:form>
	</div>
	
	
	<h:outputScript  name="js/jquery-3.3.1.min.js" />
	<h:outputScript  name="js/uikit.min.js" />
	<h:outputScript  name="js/uikit-icons.min.js" />
	<h:outputScript  name="js/alertify.min.js" />
	<script>
		var pesq = document.getElementsByClassName("content-box1");
		if (window.matchMedia('(min-width: 640px)').matches){
			UIkit.sticky(pesq[0],{offset: 20});
		}
		
		if(!alertify.myAlert){
			alertify.dialog('myAlert',function(){
			return{
				main:function(message){
			        this.message = message;
			      },
			      setup:function(){
			          return { 
			            focus: { element:0 },
		                options:{
		                    maximizable:false,
		                    resizable:true,
		                    movable:false
		                }
			          };
			      },
			      prepare:function(){
			        this.setContent(this.message);
			      }
			  }});
			}
		$('.removeButton').click(function(){
			alertify.myAlert($('#deletePostModal').html()).resizeTo('40%','30%').setHeader('<h2>Deseja remover publicação?</h2>');
		})

		
	</script>
	
</h:body>

</html>
